<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OSRS AI Wiki Chat</title>
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="/static/apple-touch-icon.svg" />
  <link rel="manifest" href="/static/site.webmanifest" />
  <meta name="theme-color" content="#0b1320" />
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <canvas id="bg" aria-hidden="true"></canvas>
  <div class="container">
    <header class="header">
      <h1>OSRS AI Wiki Chat</h1>
      <nav>
        <span class="visits-pill" title="Total site visits">
          <span>Visits: <span id="visitsTotal">0</span></span>
        </span>
        <span class="gold-pill" title="Total gold donated">
          <span class="gold-coin" aria-hidden="true"></span>
          <span><span id="goldTotal">0</span> gp donated</span>
        </span>
        <button id="fullscreenToggle" type="button" class="icon-btn" title="Enter fullscreen" aria-label="Enter fullscreen">
          <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" focusable="false">
            <path fill="currentColor" d="M7 14H5v5h5v-2H7v-3zm0-4h2V7h3V5H5v5zm10 9h-3v2h5v-5h-2v3zm0-14V8h2V3h-5v2h3z"/>
          </svg>
        </button>
        <button id="toggleHistory" type="button" class="sidebar-btn nav-icon-btn" aria-label="Public log">
          <svg class="nav-icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" focusable="false">
            <path fill="currentColor" d="M4 6a2 2 0 0 1 2-2h12a1 1 0 1 1 0 2H6v14a1 1 0 1 1-2 0V6Zm4 3a1 1 0 0 1 1-1h9a1 1 0 1 1 0 2H9a1 1 0 0 1-1-1Zm0 4a1 1 0 0 1 1-1h9a1 1 0 1 1 0 2H9a1 1 0 0 1-1-1Zm1 3a1 1 0 1 0 0 2h6a1 1 0 1 0 0-2H9Z"/>
          </svg>
          <span class="nav-label">Public log</span>
        </button>
        <a href="/donate" class="nav-icon-btn" aria-label="Donate">
          <svg class="nav-icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" focusable="false">
            <path fill="currentColor" d="M12 21s-7-4.35-9.33-8.6C.52 8.72 2.18 6 5.2 6c1.7 0 3.02.93 3.8 2.02C9.78 6.93 11.1 6 12.8 6c3.02 0 4.68 2.72 2.53 6.4C19 16.65 12 21 12 21Z"/>
          </svg>
          <span class="nav-label">Donate</span>
        </a>
      </nav>
    </header>

    <div class="app-layout">
      <main class="chat">
        <div class="public-notice">
          <div class="public-notice__left">
            <div class="public-notice__text">
              All interactions with <strong>Wise Old AI</strong> are publicly stored and shared.
            </div>
            <div id="viewBanner" class="public-notice__view" hidden>
              <span id="viewBannerText"></span>
            </div>
          </div>
          <button id="resumeChat" type="button" class="public-notice__action">New chat</button>
        </div>

        <div id="wikiPreview" class="wiki-preview" hidden>
          <div class="wiki-preview__head">
            <div>
              <div id="wikiPreviewTitle" class="wiki-preview__title">Wiki Preview</div>
              <a id="wikiPreviewOpen" class="wiki-preview__open" href="#" target="_blank" rel="noopener noreferrer">Open in new tab</a>
            </div>
            <button id="wikiPreviewClose" type="button" class="wiki-preview__close">Close</button>
          </div>
          <div class="wiki-preview__body">
            <img id="wikiPreviewThumb" class="wiki-preview__thumb" alt="" hidden />
            <div id="wikiPreviewExtract" class="wiki-preview__extract"></div>
          </div>
        </div>

        <div id="messages" class="messages"></div>
        <form id="chatForm" class="composer">
          <input id="message" placeholder="Ask something about OSRS..." autocomplete="off" />
          <button id="voiceToggle" type="button" class="voice-btn" title="Voice input" aria-label="Voice input">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" focusable="false">
              <path fill="currentColor" d="M12 14a3 3 0 0 0 3-3V5a3 3 0 0 0-6 0v6a3 3 0 0 0 3 3Zm5-3a1 1 0 1 0-2 0 3 3 0 0 1-6 0 1 1 0 1 0-2 0 5 5 0 0 0 4 4.9V18H9a1 1 0 1 0 0 2h6a1 1 0 1 0 0-2h-2v-2.1A5 5 0 0 0 17 11Z"/>
            </svg>
          </button>
          <button id="voiceChatToggle" type="button" class="voice-btn" title="Voice chat" aria-label="Voice chat">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" focusable="false">
              <path fill="currentColor" d="M6.62 10.79a15.46 15.46 0 0 0 6.59 6.59l2.2-2.2a1 1 0 0 1 1.02-.24c1.12.37 2.33.57 3.57.57a1 1 0 0 1 1 1V20a1 1 0 0 1-1 1C10.07 21 3 13.93 3 5a1 1 0 0 1 1-1h3.5a1 1 0 0 1 1 1c0 1.24.2 2.45.57 3.57a1 1 0 0 1-.24 1.02l-2.21 2.2Z"/>
            </svg>
          </button>
          <button type="submit">Send</button>
        </form>
        <div id="voiceStatus" class="voice-status" aria-live="polite" hidden></div>
        <div id="voiceChatPanel" class="voice-chat" hidden>
          <div class="voice-chat__row">
            <div id="voiceChatOrb" class="voice-chat__orb"></div>
            <div id="voiceChatState" class="voice-chat__state">Voice chat is off.</div>
            <button id="voiceChatDisconnect" type="button" class="voice-chat__btn" hidden>End Call</button>
          </div>
          <div class="voice-chat__volume">
            <label for="voiceChatVolume">ðŸ”Š</label>
            <input type="range" id="voiceChatVolume" min="0" max="100" value="80" />
          </div>
          <button id="pushToTalk" type="button" class="ptt-btn" disabled>Start Conversation</button>
          <div class="voice-chat__hint">Speak naturally - Wise Old AI will respond when you pause.</div>
        </div>
        <div class="hint">
          Sources are cited from configured OSRS wiki sites.
        </div>
      </main>

      <aside class="sidebar" id="historySidebar">
        <div class="sidebar-head">
          <div class="sidebar-title">Public Chat Log</div>
          <button id="refreshHistory" type="button" class="sidebar-btn">Refresh</button>
        </div>
        <div class="sidebar-note">
          Notice: all interactions with <strong>Wise Old AI</strong> are publicly stored and shared.
        </div>
        <div id="historyList" class="history"></div>
      </aside>
    </div>
  </div>

  <script src="/static/background.js"></script>
  <script src="/static/site.js"></script>
  <script src="/static/app.js"></script>
</body>
</html>
